[Service]
# Defense-in-depth sandboxing. These settings reduce the blast radius if the
# process is compromised. Review and relax if you hit issues on your distro.
# See systemd.exec(5) for details.
NoNewPrivileges=yes
PrivateTmp=yes
ProtectControlGroups=yes
ProtectKernelTunables=yes
ProtectSystem=strict
ProtectHome=yes

# Allow writes only where needed (config directory):
# Note: this matches CONFIG_DIR in src/bluetooth_screen_lock/config.py
ReadWritePaths=%h/.config/bluetooth-screen-lock

# Limit networking to what is needed: local sockets and Bluetooth only.
RestrictAddressFamilies=AF_UNIX AF_BLUETOOTH

# Additional hardening toggles
RestrictNamespaces=yes
LockPersonality=yes
MemoryDenyWriteExecute=yes
