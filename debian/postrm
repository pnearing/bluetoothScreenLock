#!/bin/sh
set -e

case "$1" in
    remove|purge|disappear)
        if command -v update-desktop-database >/dev/null 2>&1; then
            update-desktop-database -q || true
        fi
        if command -v gtk-update-icon-cache >/dev/null 2>&1; then
            for dir in /usr/share/icons/hicolor; do
                [ -d "$dir" ] && gtk-update-icon-cache -q "$dir" || true
            done
        fi
        # Clean up legacy user systemd unit if present from older packages
        UNIT="/usr/lib/systemd/user/bluetooth-screen-lock.service"
        DROPIN_DIR="/usr/lib/systemd/user/bluetooth-screen-lock.service.d"
        if [ -f "$UNIT" ]; then
            rm -f "$UNIT" || true
        fi
        if [ -d "$DROPIN_DIR" ]; then
            rmdir --ignore-fail-on-non-empty "$DROPIN_DIR" 2>/dev/null || true
        fi
    ;;
	esac

#DEBHELPER#

exit 0
